Los sistemas de detección de intrusión (IDS) y los sistemas de prevención de intrusión (IPS) desempeñan un papel fundamental en las operaciones de seguridad. Ambos sistemas supervisan el tráfico de la red, y buscan patrones o actividades sospechosas que podrían indicar una intrusión en la red o en el sistema. Sin embargo, difieren en sus capacidades y respuestas a las amenazas percibidas.

Los sistemas de detección de intrusión (IDS) basados en el host y en la red y los sistemas de prevención de intrusión (IPS) ofrecen, cada uno, ventajas únicas para proteger una red, y el uso de ambos en conjunto a menudo conduce a una postura de seguridad más sólida. Los IDS/IPS basados en el host (HIDS/HIPS) se instalan en sistemas o servidores individuales, y supervisan y analizan el comportamiento y las configuraciones del sistema en busca de actividades sospechosas. Los HIDS/HIPS son particularmente efectivos para identificar amenazas internas, detectar cambios en los archivos del sistema y monitorear eventos fuera de la red, como los inicios de sesión locales y los procesos del sistema. Esto hace que sean fundamentales para proteger los sistemas críticos de las amenazas internas y externas. 

OSSEC es una solución HIDS de código abierto que realiza análisis de registros, verificación de integridad, monitoreo del registro de Windows, detección de rootkit, alertas en tiempo real y respuesta activa. Es compatible con múltiples plataformas, como Linux, Windows y MacOS.

Los IDS/IPS basados en la red (NIDS/NIPS) supervisan el tráfico de la red. Buscan patrones o firmas de amenazas conocidas y un comportamiento inusual de los paquetes de red. Los NIDS/NIPS son efectivos para identificar y responder a las amenazas en múltiples sistemas, como los ataques de denegación de servicio distribuido (DDoS) o las actividades de análisis de la red. 

A pesar de sus fortalezas, ningún tipo puede sustituir por completo al otro. Los HIDS/HIPS se limitan a las actividades en el host en el que se instalan, por lo que no detectan de manera efectiva las anomalías en toda la red. Del mismo modo, los NIDS/NIPS no pueden proporcionar una visibilidad detallada de las actividades específicas del host ni detectar amenazas que no impliquen tráfico de red.

Ejemplos de herramientas de IDS e IPS
Los sistemas de detección de intrusión (IDS), como Snort, están diseñados para detectar amenazas potenciales y generar alertas. Los sistemas IDS son pasivos, inspeccionan el tráfico de la red, identifican posibles amenazas en función de reglas predefinidas o comportamientos inusuales, y envían alertas a los administradores. No bloquean ni previenen de manera activa las amenazas, pero notifican el posible problema. Esto permite a los analistas de seguridad investigar la alerta, a fin de evitar interrupciones en el tráfico de la red o el posible bloqueo del tráfico legítimo causado por falsos positivos.

Encontrará una excelente descripción y desglose de las reglas de Snort en https://snort.org/documents#OfficialDocumentation.

Por el contrario, los sistemas de prevención de intrusión (IPS), como Suricata, son herramientas de seguridad proactivas que detectan amenazas potenciales y toman medidas para prevenirlas o mitigarlas. Un IPS identifica una amenaza mediante métodos similares a los de un IDS y puede bloquear el tráfico desde el origen infractor, eliminar paquetes maliciosos o restablecer las conexiones para interrumpir un ataque. Si bien esto puede prevenir daños de inmediato, existe el riesgo de que los falsos positivos lleven a bloquear el tráfico legítimo.

Entre las herramientas importantes de IDS e IPS se incluyen las siguientes:

Snort es una de las herramientas de IDS más conocidas. Utiliza un lenguaje basado en reglas, que combina las ventajas de los métodos de inspección basados en firmas, protocolos y anomalías, y proporciona capacidades de detección sólidas. La naturaleza de código abierto de Snort y su adopción generalizada dieron lugar a una gran comunidad que contribuye con reglas y configuraciones, lo que la convierte en una herramienta versátil para diversos entornos.
Suricata es un motor IDS/IPS/NSM de código abierto de alto rendimiento. Suricata está diseñado para aprovechar al máximo el hardware moderno y ofrecer un mayor rendimiento y escalabilidad que Snort. Suricata puede funcionar como un IDS o un IPS, y es compatible con los conjuntos de reglas de Snort, lo que la convierte en una opción altamente flexible para la seguridad de la red.
Security Onion es una distribución de Linux diseñada para la detección de intrusiones, el monitoreo de la seguridad de la red y la administración de registros. Incluye tanto Snort como Suricata, junto con una serie de otras herramientas, para ofrecer una plataforma completa para la seguridad de la red. Esta integración proporciona una visión holística de la actividad de la red, lo que permite a los administradores correlacionar los datos de diferentes herramientas y obtener una comprensión integral de la postura de seguridad de la red.
![[Pasted image 20250328115349.png]]

El panel de alertas de Security Onion que muestra varias alertas capturadas por medio del conjunto de reglas de amenazas emergentes (ET) y Suricata. (Captura de pantalla utilizada con el permiso de Security Onion).