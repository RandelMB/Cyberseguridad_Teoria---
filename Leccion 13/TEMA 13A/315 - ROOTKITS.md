En Windows, el malware troyano que depende de la ejecución manual por parte del usuario que ha iniciado sesión hereda los privilegios de esa cuenta de usuario. Si la cuenta solo tiene permisos estándar, el malware solo podrá agregar, cambiar o eliminar archivos en el perfil del usuario y ejecutar solo aplicaciones y comandos que el usuario tenga permitido.

Si el malware intenta cambiar archivos o configuraciones de todo el sistema, requiere privilegios de nivel de administrador local. Para obtenerlos mediante instalación o ejecución manual, el usuario debe tener suficiente confianza en el paquete troyano para confirmar el mensaje de Control de cuentas de usuario (UAC) o ingresar las credenciales de un usuario administrativo.

Si el malware obtiene privilegios de administrador local, aún existen protecciones en Windows para mitigar el abuso de estos permisos. Los procesos críticos se ejecutan con un nivel de privilegio superior denominado SYSTEM. Por consiguiente, los troyanos instalados o ejecutados con privilegios de administrador local no pueden ocultar su presencia por completo y se mostrarán como un proceso o servicio en ejecución. A menudo, el nombre de la imagen del proceso se configura para parecerse a un ejecutable o biblioteca genuinos para evitar la detección. Por ejemplo, un troyano podría utilizar el nombre de archivo “rund1132.exe” para hacerse pasar por “rundll32.exe”. A fin de garantizar la persistencia (ejecutarse cuando se reinicia el equipo), el troyano puede tener que usar una entrada de registro o crearse a sí mismo como un servicio, que por lo general se puede detectar fácilmente.

Si el malware puede entregarse como carga útil para la explotación de una vulnerabilidad grave, es posible que pueda ejecutarse sin requerir ninguna autorización utilizando los privilegios SYSTEM. De manera alternativa, el malware puede usar una vulnerabilidad de seguridad para escalar privilegios a nivel de SYSTEM después de la instalación. El malware que se ejecuta con este nivel de privilegio se conoce como rootkit. El término deriva de UNIX/Linux, donde cualquier proceso que se ejecute con la cuenta de superusuario raíz (root) tiene acceso irrestricto a todo, desde la raíz del sistema de archivos hacia abajo. 

En teoría, no hay nada en el sistema que un rootkit no pueda cambiar. En la práctica, Windows usa otros mecanismos para evitar el uso indebido de los procesos de kernel, como la firma de código. Por consiguiente, lo que puede hacer un rootkit depende en gran medida de la capacidad y del nivel de esfuerzo del adversario. Cuando se trata con un rootkit, debe tener en cuenta que existe la posibilidad de que pueda comprometer archivos del sistema e interfaces de programación, de modo que los procesos de shell locales, como Explorer, taskmgr o tasklist en Windows, o ps o top en Linux, además de las herramientas de análisis de puertos, como netstat, ya no revelen su presencia (al menos, si se ejecutan desde la máquina infectada). Un rootkit también puede contener herramientas para limpiar los registros del sistema, lo que oculta aún más su presencia. 

Los procesos de software pueden ejecutarse en uno de varios anillos. El anillo 0 es el más privilegiado (proporciona acceso directo al hardware) y, por lo tanto, debe reservarse únicamente para los procesos del kernel. El anillo 3 es donde se ejecutan los procesos en modo de usuario; los controladores y los procesos de entrada/salida (I/O) pueden ejecutarse en el anillo 1 o en el anillo 2. Esta arquitectura también puede complicarse por el uso de la virtualización.

También hay ejemplos de rootkits que pueden residir en el firmware (ya sea el firmware del equipo o de cualquier tipo de tarjeta adaptadora, disco duro, unidad extraíble o dispositivo periférico). Estos rootkits pueden sobrevivir a cualquier intento de eliminación formateando el disco y reinstalando el sistema operativo. Por ejemplo, las agencias de inteligencia de los Estados Unidos desarrollaron rootkits UEFI llamados DarkMatter y Quark Matter dirigidos al firmware de los equipos portátiles Apple Macbook.